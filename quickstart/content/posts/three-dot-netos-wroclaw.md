---
title: 'Three Dot Netos - Wrocaw'
slug: '/2018/03/18/three-dot-netos-wroclaw/'
date: Sun, 18 Mar 2018 19:16:13 +0000
draft: false
category: 'Recenzja'
tags: ['.Net', 'performance', 'three dot netos']
---

[Trzej Dot Netos](https://dotnetos.org/)w skadzie ukasz Pyrzyk, Konrad Kokosa i Szymon Kulec 16 marca odwiedziliWrocaw. Maestro wydajnoci i sztuki optymalizacji opowiadali otematach im bliskim:

*   How to make a tabasco sauce from a GPU using C# - ukasz
*   A Garbage Collector, his collections and what it implies for you - Konrad
*   The Secret Serialization Sauce and its spicy mysteries - Szymon

Wszystko podlane odpowiedni ilociostrego sosu, by doprowadzi uczestnik贸w do wrzenia od iloci technologicznej wiedzy 

Obsuga GPU z poziomu C# -ukasz
---------------------------------

[![](https://radblog.pl/wp-content/uploads/2018/03/DYbRI3yXcAYQkcZ-1024x576.jpg)](https://radblog.pl/wp-content/uploads/2018/03/DYbRI3yXcAYQkcZ.jpg) ukasz opowiedzia o obsudze GPU z poziomu kodu C#. Mo偶e nam si to wydawa zbyteczne - po co zajmowa si takimi rzeczami? Okazuje si, 偶e u偶ycie przez StackOverflow karty graficznej za 400$ do przetwarzania informacji o tagach byo wydajniejsze ni偶 u偶ycie serwera z 72 rdzeniami CPU. **Ogromny przyrost mocy za pomoc u偶ycia podstawowych komponent贸w**. Jest to spowodowane faktem, 偶e karty graficzne maj ukady GPU zoptymalizowane do przetwarzania bardzo du偶ych iloci danych w konkretnie okrelony spos贸b. CPU nie jest w stanie konkurowa z nimi w kontekcie mocy, za to jest o wiele lepszy do zr贸偶nicowanych operacji.[Tutaj](https://www.quora.com/Whats-the-difference-between-a-CPU-and-a-GPU-When-I-switch-on-my-computer-it-shows-GPU-information-What-does-it-mean) wicej na ten temat. Jeli nie mamy karty graficznej (ukasz te偶 nie ma ) to mo偶na u偶y chmury Azure i wirtualnych maszyn z dostpnymi kartami graficznymi. S one [odpowiednio dro偶sze](https://azure.microsoft.com/en-us/pricing/details/virtual-machines/linux/), ale mamy dostp do naprawd pot偶nego sprztu - [NVidia Tesla P40](https://www.nvidia.com/object/accelerate-inference.html). GPU jest dobre do obsugi du偶ej iloci maych zada, wic **nie sprawdzi si w ka偶dym przypadku**:

1.  Kiedy nie mamy operacji r贸wnoleglych.
2.  Kiedy mamy r贸偶norodno zada - GPU nie da rady obsu偶y wielu r贸偶nych problem贸w jednoczenie.
3.  Kiedy musimy si synchronizowa.
4.  Kiedy u偶ywany du偶o pamici.
5.  Kiedy mo偶emy zoptymalizowa kod na CPU.

ukasz do zabawy z obsug GPU poleca 2 frameworki - [Alea](http://www.aleagpu.com/release/3_0_4/doc/)i [Hybrydizer](https://devblogs.nvidia.com/hybridizer-csharp/)- pozostae nie s wspierane.

Optymalizacja zu偶ycia pamici - Konrad
--------------------------------------

[![](https://radblog.pl/wp-content/uploads/2018/03/DYbebQtXkAAZ_d0-1024x576.jpg)](https://radblog.pl/wp-content/uploads/2018/03/DYbebQtXkAAZ_d0.jpg) Konrad opowiedzia o optymalizacji zu偶ycia pamici i przypieszania pracy naszych aplikacji za pomoc prostych poprawek naszego kodu. Niewielkie zmiany w naszym kodzie mog mie ogromny wpyw na wydajno i poprawi dziaanie naszej aplikacji. Pierwszym szokiem dla publicznoci by fakt, 偶e kod w **Intermediate Language** (IL) jest kompletnie inny ni偶 kod niskopoziomowy w asemblerze (ASM). Kompilator [Just In Time](https://www.telerik.com/blogs/understanding-net-just-in-time-compilation)dokonujeniesamowitych optymalizacji bynasz kod by jak najbardziej wydajny. Zbi贸r r贸偶nych metod wywoujcych siebie nawzajem mo偶e by przetransformowanych do jedynie kilku operacji w asemblerze. Ciekawym zaskoczeniem byo r贸wnie偶 pokaz r贸偶nic pomidzy klasami a strukturami. Wszyskie poradniki o C# m贸wi, 偶edane klas s przechowywane na stercie a struktur na stosie. Nie m贸wi za to, 偶e czsto mo偶emy w og贸le tego stosu nie u偶ywa bo JIT zoptymalizuje nasz kod by porusza si jedynie w kontekcie rejestr贸w i operacji na CPU.Zmiana class -> struct sprawia, 偶e **kod w ASM zmniejszy si prawie 6-krotnie**. Na koniec Konrad wspomnia o sowie kluczowym **stackalloc**, kt贸re pozwala przydzieli dla zmiennej blok pamici na stosie. U偶ycie tego zwrotu daje mo偶liwoci natychmiastowego dostepu do pamici ipotrafi znacznie przypieszy dziaanie kodu opartego o dane na sosie. U偶ywanie stackallocbyo do tej pory uci偶liwe, ale w nowym .NET 7.2 mamy mo偶liwo u偶ywania nowej struktury [Span](http://adamsitnik.com/Span/#introduction), kt贸ra obsuguje za nas obliczenia na wska藕nikach i jest bardzo wydajnym sposobem na pisanie program贸w bez potrzeby nadmiarowej alokacji pamici. Aktualnie cay wiat .NET idzie w kierunku gbszej optymalizacji zu偶ycia pamici, wida to na przykadzie ju偶 wspomnianego[Span](http://adamsitnik.com/Span/#introduction), [ValueTask](http://blog.i3arnon.com/2015/11/30/valuetask/), [ArrayPool](http://adamsitnik.com/Array-Pool/)czy[Pipelines](https://msdn.microsoft.com/en-us/library/ff963548.aspx). Caa prezentacja opieraa si nanarzdziu [Tune](https://github.com/kkokosa/Tune)- programu do ledzenia jak nasz kod C# jest transformowany doIL i ASM. Bardzo proste i pot偶ne narzdzie stworzone przez Konrada - zachca do pomocy przy rozwijaniu go 

R贸偶ne drogi serializacji w .NET - Szymon
----------------------------------------

[![](https://radblog.pl/wp-content/uploads/2018/03/20180316_201504-1024x576.jpg)](https://radblog.pl/wp-content/uploads/2018/03/20180316_201504.jpg) Szymon opowiedzia o r贸偶nych sposobach serializacji danych w .NET. Przeszed od zaszoci XMLowych, przez 2 biblioteki do serializowania JSONa po serializatory binarne i wasny serializator, stworzony na potrzeby NServiceBusa. Ka偶dy krok tospojrzenie z r贸偶nej perspektywy na potrzeby i wymagania stawiane przez nasze aplikacje. XML Szymon odrzuci ju偶 na wstpie ;) nie dziwi si temu, poniewa偶 poza wysok czytelnoci **trudno w XML o wiksze zalety**. Byo wspomniane o parserach cechujcych si wysokim zu偶yciem pamici,nisk prdkoci i og贸lnie sab jakoci dziaania. Odnonie JSONa zostay wspomniane 2 biblioteki - [JSON.NET](https://www.newtonsoft.com/json) i [Jil](https://github.com/kevin-montrose/Jil). Pierwsza z nich to najpopularniejsza biblioteka do parsowania JSON w wiecie .NET, kt贸rej domylnie u偶ywaj ju偶 wszystkie aplikacje ASP.NET. Ta druga zostaa napisana by jak **najbardziej optymalnie serializowa i deserializowa obiekty**. Jil posiada bardzo du偶o maych trick贸w i usprawnie kt贸re pozwalaj ominicie alokacji pamici i niepotrzebnych wywoa funkcji. Tw贸rcy napisali wasn obsug parsowania Int'a, za Szymon pokazywa [obsug parsowania GUID'贸w](https://github.com/kevin-montrose/Jil/blob/master/Jil/Serialize/Methods.cs#L100), kt贸ra powala na kolana. P贸藕niej kolej przysza na protokoy binarne - [Google Protocol Buffer](https://developers.google.com/protocol-buffers/), [Wire](https://github.com/rogeralsing/Wire) / [Hyperion](https://github.com/akkadotnet/Hyperion) i inne. **Protocol Buffer** pozwala na utworzenie schematu danych pomidzy end-pointami a nastpnie serializowanie danych bezporednio do strumienia bajt贸w. Te nastpnie s deserializowane wg schematu po drugiej stronie. Ciekawy koncept pozwalajcy na wysok wydajno i mniejsze zu偶ycie miejsca, kosztem czytelnoci. Podobnie dziaa **Wire / Hyperion**, kt贸re dziaaj jedynie w rodowisku .NET, ale s bardziej rozszerzalne - obsuguj wersjonowanie, polimorficzn serializacje itd. Na koniec Szymon wspomnia oserializatorze, kt贸ry napisali na potrzeby **NServiceBusa.** W firmie potrzebowali logowa wszystkie zdarzenia jakie nastpoway w kontekcie obsugi wiadomoci.Dzikigbokiemu zrozumieniu wymaga i sytuacji, w kt贸rej chc wykorzysta sw贸j serializator, maksymalnie wykorzystali alokacj pamici ipominli cz p贸l. Pozwolio im to osign wysok wydajno, jaka jest potrzebna przy olbrzymiej iloci wiadomoci u偶ywanej przez ich szyn. Szymon bardzo mocno podkreli, 偶e **pisanie swojego serializatora powinno nastpi tylko wtedy, kiedy nie mamy ju偶 innej opcji**. W pozostaych sytuacjach wystarcz poprzednie serializatory.

Marketing - Three Dot Netos
---------------------------

To wydarzenie byoby i tak wietnie znane w spoecznoci .NET, nawet bez mocnej promocji. Ale dobry marketing pozwala na zwikszenie zainteresowania i promuje dobre strony wydarze. Tutaj to zagrao znakomicie: Chopaki postanowili stworzy sp贸jny branding dla swojej inicjatywy i reklamowa siebie jako 3 gringos - **"UNSAFE AND FURIOUS!"**. I wyszo wietnie - nikt wczeniej czego podobnego w Polsce nie zrobi. Wynikiem bya silna, oddolna promocja na Facebooku, Twitterze, Linkedinie ibardzo du偶a ilo uczestnik贸w na ich eventach (we Wrocawiu w pitek wiecz贸r zapenili prawie ca sal w Sali Kongresowej Hali Stulecia). Uczestnicy wiedzieli, 偶e przychodz na wydarzenie wymiataczy .NET, ale z nastawieniem na dobr zabaw i integracje. Strzaem w dziesitk byy **sosy tabasco**, brandowane ich inicjatyw.Sosy byy dostpne dla uczestnik贸w wydarzenia w ramach pyta i odpowiedzi, co dawao fajny kontakt z publicznoci i lepszy odbi贸r samych prezentacji. Ludzie chtnie si anga偶owali,byy dyskusje, wymiana dowiadcze. Sam sos by te偶 dostpny w trybie Insider, ja dostaem go w takim piknym pudeeczku ju偶 nieco wczeniej  [![](https://radblog.pl/wp-content/uploads/2018/03/DYRKTb4WkAEiR-L-225x300.jpg)](https://radblog.pl/wp-content/uploads/2018/03/DYRKTb4WkAEiR-L.jpg)[![](https://radblog.pl/wp-content/uploads/2018/03/20180228_114921-2-169x300.jpg)](https://radblog.pl/wp-content/uploads/2018/03/20180228_114921-2.jpg)

Podsumowanie
------------

Zbierajc informacje o tym evencie razem - byo to wietne wydarzenie, zar贸wno pod ktem merytorycznym jak i spoecznociowym. Du偶a dawka wiedzy, mili ludzie, przyjemny after-party.Czekam z niecierpliwoci co 3 gringos jeszcze wymyl  [![](https://radblog.pl/wp-content/uploads/2018/03/DYkI2D4WAAAQztU-300x225.jpg)](https://radblog.pl/wp-content/uploads/2018/03/DYkI2D4WAAAQztU.jpg) PS. Zagarnita sala w Kociej Koysce przez team .NET 